# TNBC Multi-Omics (Bhaskarao Ch)

[![License: MIT](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Release](https://img.shields.io/github/v/release/Baashi27-ai/tnbc---multiomics)](https://github.com/Baashi27-ai/tnbc---multiomics/releases)
[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.17905856.svg)](https://doi.org/10.5281/zenodo.17905856)

---

### üîó Quick Navigation  
- [Project Overview](#project-overview)  
- [Key Highlights](#key-highlights)  
- [Repository Layout](#repository-layout)  
- [Example Figures](#example-figures)  
- [Getting Started](#getting-started)  
- [Workflow](#workflow-end-to-end)  
- [Milestones](#milestones)  
- [Citation](#citation)  
- [Author & License](#author--license)  

---

## üìò Project Overview
End-to-end analysis of Triple-Negative Breast Cancer (TNBC) using:  

- RNA-seq (expression profiling)  
- DNA methylation (DMPs)  
- Genomic mutations (TMB mutational profiling)  
- Proteomics (GSVA/PROGENY panels)  

Multi-omics integration was performed using Similarity Network Fusion (SNF) and consensus clustering, validated by survival analysis (KM/Cox), and pathway enrichment (GO/GSVA/PROGENY).  
Model explainability was provided with SHAP.  

---


## ‚ú® Key Highlights
- Integration: SNF + consensus ‚Üí stable TNBC subtypes  
- Biology: GO/Reactome enrichment; GSVA panels; PROGENy TF activity  
- Outcomes: Kaplan-Meier & age-adjusted Cox confirm prognostic separation  
- Explainability: SHAP summaries + feature prep scripts  

---

## üìÇ Repository Layout

| Folder / File | Description |
|---------------|-------------|
| data/       | Input data (placeholders only; see data/README.md) |
| figures/    | All key plots (Volcano, KM, Cox, SNF, SHAP, etc.) with guide |
| reports/    | Human-readable reports & slide decks |
| results/    | Processed outputs (plots, tables, checkpoints) |
| src/        | Source code scripts for full pipeline |
| env/        | Environment & session info |
| run_all.R   | Master script to run entire workflow |
| LICENSE     | MIT License |
| README.md   | Project overview & documentation |

---

---

## ‚öô Environment & Reproducibility
- environment.yml (conda)  
- sessionInfo.txt (R)  
- Scripts in scripts/ are numbered by analysis phase.  
- Results are fully reproducible on TCGA-TNBC public data.  

---

## üõ† Analysis Flow / Milestones
1. *Data preprocessing*  
   - Clinical annotation (proxy subtype assignment)  
   - RNA-seq normalization & QC  
   - Methylation preprocessing & QC  

2. *Differential expression / methylation*  
   - TNBC vs non-TNBC  
   - Volcano plots, Venn overlap  

3. *Integration & clustering*  
   - SNF on RNA+methylation (k=6)  
   - Consensus clustering cross-check  

4. *Survival analyses*  
   - Kaplan‚ÄìMeier curves by SNF cluster  
   - Cox proportional hazard models  

5. *Enrichment & biology*  
   - GO/KEGG/Reactome per cluster  
   - TF activity (PROGENy, TFA)  

6. *Downstream characterization*  
   - TMB and mutation profiles  
   - Oncoplots  

7. *Drug repurposing & ML*  
   - DGIdb, OpenTargets, PharmGKB  
   - SHAP-based feature importance  

---

## üßÆ Cohort Audit (TNBC)

- *RNA-seq (TNBC):* 190 patients  
- *DNA methylation (TNBC):* 135 patients  
- *Mutations/TMB (TNBC):* 168 patients  

*Overlaps (12-char TCGA barcodes):*
- RNA ‚à© Methylation = *135*  ‚Üê SNF integration cohort used for clustering  
- RNA ‚à© Methylation ‚à© Mutations = *116* (subset used for TMB/mutation summaries)  

Audit artifacts (generated by scripts/cohort_audit.R):  
- results/audit/per_modality_counts_raw.tsv  
- results/audit/per_modality_counts_harmonized.tsv  
- results/audit/pairwise_overlap_harmonized.tsv  
- results/audit/overlap_3way_TNBC_harmonized.tsv  
- results/audit/ids_<MODALITY>_harmonized.tsv  

---

## ‚öó Methods (Parameters)

To ensure transparency and reproducibility, here are the key parameters used across the analysis:

### Preprocessing
- *RNA-seq:*  
  - Normalization: Variance Stabilizing Transformation (VST, DESeq2)  
  - Filter: remove low-count genes (<10 counts across >80% of samples)  

- *DNA methylation:*  
  - Input: TCGA 450k processed beta-values  
  - Filter: probes with >20% missing values removed  
  - Imputation: kNN (k = 5)  

- *Somatic mutations / TMB:*  
  - Input: TCGA MAF (TNBC subset)  
  - TMB calculated as total nonsynonymous mutations / Mb  

---

### Differential Analysis
- *RNA-seq (DESeq2):*  
  - TNBC vs non-TNBC  
  - Thresholds: FDR < 0.05, |log2FC| > 1  

- *Methylation (limma):*  
  - TNBC vs non-TNBC  
  - Differentially methylated probes (DMPs): adj.p < 0.05, ŒîŒ≤ > 0.2  

---

### Integration & Clustering
- *Similarity Network Fusion (SNF):*  
  - K = 6 (final consensus)  
  - Hyperparameters: K-neighbors = 20, Œ± = 0.5, T = 20 iterations  
  - Data fused: RNA-seq (190 TNBC), Methylation (135 TNBC)  

- *Consensus Clustering (ConsensusClusterPlus):*  
  - Iterations = 1000, subsampling = 80%  
  - Distance = Pearson correlation  
  - K = 6 confirmed  

---

### Survival Analysis
- *Kaplan‚ÄìMeier:* log-rank test across SNF clusters  
- *Cox Proportional Hazards models:*  
  - Unadjusted and age-adjusted  
  - Outputs: HR ¬± 95% CI, forest plots  
  - PH assumption checked (cox.zph)  

---

### Enrichment & Biology
- *Pathway analysis:* GO, KEGG, Reactome (clusterProfiler)  
  - Significance: adj.p < 0.05  
- *GSVA:* Hallmark pathways, continuous score by patient  
- *PROGENy & TF Activity:* Top 14 signaling pathways & TF regulons per cluster  

---

### Drug Repurposing
- Cross-referenced cluster markers with:  
  - *DGIdb* (Drug‚ÄìGene Interaction Database)  
  - *OpenTargets*  
  - *PharmGKB*  

---

### Explainability
- *SHAP (SHapper + iml):*  
  - Model: XGBoost classifier (RNA features)  
  - Top 20 features plotted (global + classwise)  
  - Explainers validated with permutation checks


## üìä Figures & Deliverables
Key plots include:
- Volcano plots (RNA-seq, methylation, per-cluster)  
- Venn diagrams of DEGs vs DMP-associated genes  
- SNF UMAP & Kaplan‚ÄìMeier survival curves  
- Cox forest plots  
- Enrichment heatmaps (GO/KEGG/Reactome)  
- TMB histograms, oncoplots  
- SHAP summary plots (explainability)  

Deliverables:  
- deliverables/TNBC_slides.pptx  
- results/TNBC_report.docx  
- results/REPORTS/TNBC_quick_report.docx  
- results/REPORTS/TNBC_M1_summary.docx  

---

## üñº Figures Manifest

Below is a curated list of key figures generated in this project. Each file is available under results/plots/, deliverables/, or results/.../figures.

| Figure | Filename | Caption |
|--------|----------|---------|
| *Volcano (RNA-seq)* | volcano_DESeq2_TNBC_vs_NonTNBC.png | Differentially expressed genes between TNBC and non-TNBC. |
| *Volcano (Methylation)* | volcano_Methylation_TNBC_vs_NonTNBC.png | Differentially methylated probes (DMPs) between TNBC and non-TNBC. |
| *Venn Diagram* | venn_deg_dmp.png | Overlap between DEGs and DMP-associated genes. |
| *SNF UMAP* | SNF_UMAP.png | Low-dimensional embedding of fused multi-omics (RNA + methylation). |
| *Kaplan‚ÄìMeier Curves* | KM_SNF_clusters.png | Survival probability across SNF clusters (K=6). |
| *Cox Forest Plot* | Forest_Cox_HR_SNF_clusters.png | Hazard ratios for SNF clusters (unadjusted). |
| *Cox Forest Plot (age-adjusted)* | Forest_Cox_HR_SNF_clusters_ageAdjusted.png | Hazard ratios adjusted for age. |
| *Pathway Enrichment (GO BP)* | GO_BP_DOWN_cluster1.png, etc. | Cluster-wise GO Biological Process enrichments. |
| *Pathway Enrichment (KEGG/Reactome)* | KEGG_cluster2_UP.png, Reactome_cluster3_DOWN.png | Functional pathway enrichment per cluster. |
| *TMB Histogram* | TMB_hist_TNBC.png | Tumor Mutational Burden distribution in TNBC patients. |
| *Oncoplot* | oncoplot_TNBC_top20.png | Top 20 recurrently mutated genes in TNBC cohort. |
| *SHAP Summary* | shap_summary.png | Global feature importance from explainable ML (RNA-based XGBoost). |

---

### Notes
- High-resolution *PDF versions* are available alongside PNGs in results/plots/.  
- Cluster-specific enrichment plots are under results/enrichment/ and results/markers_strict_enrichment/.  
- Cohort audit TSVs are under results/audit/ for reproducibility.

## üñº Example Figures

<p align="center">
  <img src="figures/volcano_DESeq2_TNBC_vs_NonTNBC.png" alt="RNA-seq Volcano" width="45%"/>
  <img src="figures/volcano_Methylation_TNBC_vs_NonTNBC.png" alt="Methylation Volcano" width="45%"/>
</p>

<p align="center">
  <img src="figures/venn_deg_dmp.png" alt="DEG-DMP Overlap" width="45%"/>
  <img src="figures/SNF_UMAP.png" alt="SNF UMAP Clusters" width="45%"/>
</p>

<p align="center">
  <img src="figures/KM_SNF_clusters.png" alt="Kaplan-Meier by SNF Clusters" width="45%"/>
  <img src="figures/cox_forest_by_cluster.png" alt="Cox Regression Forest" width="45%"/>
</p>

<p align="center">
  <img src="figures/GO_BP_HypoUp_top15.png" alt="GO BP HypoUp Pathways" width="45%"/>
  <img src="figures/shap_summary.png" alt="SHAP Feature Summary" width="45%"/>
</p>

---

## üîß Workflow (end-to-end)

*Inputs ‚Üí Processing ‚Üí Outputs*

- *Input data:* RNA-seq counts, DNA methylation (DMPs), Mutations (MAF/TMB), Proteomics (GSVA/PROGENy)  
- *Processing:* QC & normalization ‚Üí SNF integration ‚Üí Consensus clustering  
- *Outputs:* Survival analysis (KM/Cox), Pathway enrichment (GO/Reactome), Explainability (SHAP)  

---

## üöÄ Getting Started

Clone the repository and run the master script:

bash
git clone https://github.com/Baashi27-ai/tnbc---multiomics.git
cd tnbc---multiomics
Rscript run_all.R


### Requirements
This pipeline was developed and tested in *R 4.3*.  
Install the following R packages before running:

r
install.packages(c("tidyverse","data.table","ComplexHeatmap","survival","survminer",
                   "ConsensusClusterPlus","SNFtool","GSVA","progeny","maftools",
                   "ggplot2","shapper","iml","caret"))


### Directory overview
- data/ ‚Üí input data (RNA-seq, methylation, mutations, proteomics)  
- figures/ ‚Üí key result plots (volcano, SNF, KM, Cox, SHAP, oncoplot)  
- reports/ ‚Üí DOCX/PPTX reports and slides  

---

## üìñ Citation

If you use this repository, please cite:

Bhaskarao, C. (2025). TNBC Multi-Omics: End-to-end Integration Pipeline. Learning Lab Research Institute. Zenodo. https://doi.org/10.5281/zenodo.17905856  

---

### üìö BibTeX  
[![Cite BibTeX](https://img.shields.io/badge/Cite-BibTeX-blue)](https://doi.org/10.5281/zenodo.17905856)

```bibtex
@software{bhaskarao2025tnbc,
  author       = {Bhaskarao Ch},
  title        = {TNBC Multi-Omics: End-to-end Integration Pipeline},
  institution  = {Learning Lab Research Institute},
  year         = {2025},
  publisher    = {Zenodo},
  doi          = {10.5281/zenodo.17905856},
  url          = {https://doi.org/10.5281/zenodo.17905856}
}
üìö APA



Bhaskarao, C. (2025). TNBC Multi-Omics: End-to-end Integration Pipeline. Learning Lab Research Institute. Zenodo. https://doi.org/10.5281/zenodo.17905856

## üë§ Author & License

- *Author:* Bhaskarao Ch (GitHub: [Baashi27-ai](https://github.com/Baashi27-ai))  
- *Email:* bhaskarch.1602@gmail.com  
- *License:* MIT  

---

## üìå Milestones
- ‚úÖ Data integration completed  
- ‚úÖ Stable TNBC subtypes identified  
- ‚úÖ Survival-linked pathways validated  
- ‚úÖ Reports & figures compiled  
- üîÑ Next: AI/ML drug discovery expansion
